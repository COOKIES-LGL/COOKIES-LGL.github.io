(self.webpackChunkvuepress_blog=self.webpackChunkvuepress_blog||[]).push([[8008],{3579:(n,s,a)=>{"use strict";a.r(s),a.d(s,{data:()=>t});const t={key:"v-51b54666",path:"/pages/blog-daily/chrome-plugin/",title:"",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"开发与调试",slug:"开发与调试",children:[]},{level:2,title:"基础介绍",slug:"基础介绍",children:[{level:3,title:"manifest.json",slug:"manifest-json",children:[]},{level:3,title:"content-scripts",slug:"content-scripts",children:[]},{level:3,title:"background",slug:"background",children:[]},{level:3,title:"event-pages",slug:"event-pages",children:[]},{level:3,title:"popup",slug:"popup",children:[]},{level:3,title:"injected-script",slug:"injected-script",children:[]},{level:3,title:"option(选项页)",slug:"option-选项页",children:[]}]},{level:2,title:"Chrome 插件的六种展示形式",slug:"chrome-插件的六种展示形式",children:[{level:3,title:"browserAction(地址栏右侧)",slug:"browseraction-地址栏右侧",children:[]},{level:3,title:"pageAction(地址栏右侧)",slug:"pageaction-地址栏右侧",children:[]},{level:3,title:"contextMenus(右键菜单)",slug:"contextmenus-右键菜单",children:[]},{level:3,title:"override(覆盖特定页面)",slug:"override-覆盖特定页面",children:[]},{level:3,title:"devtools(开发者工具)",slug:"devtools-开发者工具",children:[]},{level:3,title:"omnibox (搜索建议)",slug:"omnibox-搜索建议",children:[]}]},{level:2,title:"五种 JS 类型的对比",slug:"五种-js-类型的对比",children:[{level:3,title:"权限对比",slug:"权限对比",children:[]},{level:3,title:"消息通信",slug:"消息通信",children:[]},{level:3,title:"通信详细介绍",slug:"通信详细介绍",children:[]},{level:3,title:"content-script 主动发消息给后台",slug:"content-script-主动发消息给后台",children:[]},{level:3,title:"injected script 和 content-script",slug:"injected-script-和-content-script",children:[]},{level:3,title:"长连接和短连接",slug:"长连接和短连接",children:[]},{level:3,title:"跨扩展程序消息传递",slug:"跨扩展程序消息传递",children:[]}]},{level:2,title:"其它补充",slug:"其它补充",children:[{level:3,title:"本地存储",slug:"本地存储",children:[]},{level:3,title:"webRequest",slug:"webrequest",children:[]}]}],filePathRelative:"pages/blog-daily/chrome-plugin/README.md",git:{updatedTime:1733294272e3,contributors:[{name:"guilin.li",email:"1344714332@qq.com",commits:6},{name:"COOKIES-LGL",email:"1344714332@qq.com",commits:1}]}}},1829:(n,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>Gn});var t=a(6252);const e=(0,t.uE)('<h2 id="开发与调试"><a class="header-anchor" href="#开发与调试">#</a> 开发与调试</h2><p>Chrome 插件是一个由 HTML、CSS、JS、图片等资源组成的压缩包,保证根目录有<strong>manifest.json</strong>即可。<br> 在扩展程序管理页面,可以将包含扩展程序的文夹打包成 crx 文件.因为 Chrome 要求插件必须从它的 Chrome 应用商店安装，其它任何网站下载的都无法直接安装，所以我们可以把 crx 文件解压，然后通过开发者模式直接加载,点击扩展程序的<strong>查看视图</strong>即可进入调试页面。</p><h2 id="基础介绍"><a class="header-anchor" href="#基础介绍">#</a> 基础介绍</h2><h3 id="manifest-json"><a class="header-anchor" href="#manifest-json">#</a> manifest.json</h3><p>这是一个 Chrome 插件最重要也是必不可少的文件，用来配置所有和插件相关的配置，必须放在根目录。其中， <strong>manifest_version</strong>、<strong>name</strong>、<strong>version</strong>3 个是必不可少的，<strong>description</strong>和<strong>icons</strong>是推荐的。</p><p>下面给出的是一些常见的配置项:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>\n <span class="token comment">// 清单文件的版本，这个必须写，而且必须是2</span>\n <span class="token string">&quot;manifest_version&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>\n <span class="token comment">// 插件的名称</span>\n <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;demo&quot;</span><span class="token punctuation">,</span>\n <span class="token comment">// 插件的版本</span>\n <span class="token string">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span>\n <span class="token comment">// 插件描述</span>\n <span class="token string">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;简单的Chrome扩展demo&quot;</span><span class="token punctuation">,</span>\n <span class="token comment">// 图标，一般偷懒全部用一个尺寸的也没问题</span>\n <span class="token string">&quot;icons&quot;</span><span class="token operator">:</span>\n <span class="token punctuation">{</span>\n  <span class="token string">&quot;16&quot;</span><span class="token operator">:</span> <span class="token string">&quot;img/icon.png&quot;</span><span class="token punctuation">,</span>\n  <span class="token string">&quot;48&quot;</span><span class="token operator">:</span> <span class="token string">&quot;img/icon.png&quot;</span><span class="token punctuation">,</span>\n  <span class="token string">&quot;128&quot;</span><span class="token operator">:</span> <span class="token string">&quot;img/icon.png&quot;</span>\n <span class="token punctuation">}</span><span class="token punctuation">,</span>\n <span class="token comment">// 会一直常驻的后台JS或后台页面</span>\n <span class="token string">&quot;background&quot;</span><span class="token operator">:</span>\n <span class="token punctuation">{</span>\n  <span class="token comment">// 2种指定方式，如果指定JS，那么会自动生成一个背景页</span>\n  <span class="token string">&quot;page&quot;</span><span class="token operator">:</span> <span class="token string">&quot;background.html&quot;</span>\n  <span class="token comment">//&quot;scripts&quot;: [&quot;js/background.js&quot;]</span>\n <span class="token punctuation">}</span><span class="token punctuation">,</span>\n <span class="token comment">// 浏览器右上角图标设置，browser_action、page_action、app必须三选一</span>\n <span class="token string">&quot;browser_action&quot;</span><span class="token operator">:</span>\n <span class="token punctuation">{</span>\n  <span class="token string">&quot;default_icon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;img/icon.png&quot;</span><span class="token punctuation">,</span>\n  <span class="token comment">// 图标悬停时的标题，可选</span>\n  <span class="token string">&quot;default_title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;这是一个示例Chrome插件&quot;</span><span class="token punctuation">,</span>\n  <span class="token string">&quot;default_popup&quot;</span><span class="token operator">:</span> <span class="token string">&quot;popup.html&quot;</span>\n <span class="token punctuation">}</span><span class="token punctuation">,</span>\n <span class="token comment">// 当某些特定页面打开才显示的图标</span>\n <span class="token comment">/*&quot;page_action&quot;:\n {\n  &quot;default_icon&quot;: &quot;img/icon.png&quot;,\n  &quot;default_title&quot;: &quot;我是pageAction&quot;,\n  &quot;default_popup&quot;: &quot;popup.html&quot;\n },*/</span>\n <span class="token comment">// 需要直接注入页面的JS</span>\n <span class="token string">&quot;content_scripts&quot;</span><span class="token operator">:</span>\n <span class="token punctuation">[</span>\n  <span class="token punctuation">{</span>\n   <span class="token comment">//&quot;matches&quot;: [&quot;http://*/*&quot;, &quot;https://*/*&quot;],</span>\n   <span class="token comment">// &quot;&lt;all_urls&gt;&quot; 表示匹配所有地址</span>\n   <span class="token string">&quot;matches&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;&lt;all_urls&gt;&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n   <span class="token comment">// 多个JS按顺序注入</span>\n   <span class="token string">&quot;js&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;js/jquery-1.8.3.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;js/content-script.js&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n   <span class="token comment">// JS的注入可以随便一点，但是CSS的注意就要千万小心了，因为一不小心就可能影响全局样式</span>\n   <span class="token string">&quot;css&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;css/custom.css&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n   <span class="token comment">// 代码注入的时间，可选值： &quot;document_start&quot;, &quot;document_end&quot;,</span>\n   <span class="token comment">// or &quot;document_idle&quot;, 最后一个表示页面空闲时，默认document_idle</span>\n   <span class="token string">&quot;run_at&quot;</span><span class="token operator">:</span> <span class="token string">&quot;document_start&quot;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token comment">// 这里仅仅是为了演示content-script可以配置多个规则</span>\n  <span class="token punctuation">{</span>\n   <span class="token string">&quot;matches&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;*://*/*.png&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*://*/*.jpg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*://*/*.gif&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*://*/*.bmp&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n   <span class="token string">&quot;js&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;js/show-image-content-size.js&quot;</span><span class="token punctuation">]</span>\n  <span class="token punctuation">}</span>\n <span class="token punctuation">]</span><span class="token punctuation">,</span>\n <span class="token comment">// 权限申请</span>\n <span class="token string">&quot;permissions&quot;</span><span class="token operator">:</span>\n <span class="token punctuation">[</span>\n  <span class="token string">&quot;contextMenus&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 右键菜单</span>\n  <span class="token string">&quot;tabs&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 标签</span>\n  <span class="token string">&quot;notifications&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 通知</span>\n  <span class="token string">&quot;webRequest&quot;</span><span class="token punctuation">,</span> <span class="token comment">// web请求</span>\n  <span class="token string">&quot;webRequestBlocking&quot;</span><span class="token punctuation">,</span>\n  <span class="token string">&quot;storage&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 插件本地存储</span>\n  <span class="token string">&quot;http://*/*&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 可以通过executeScript或者insertCSS访问的网站</span>\n  <span class="token string">&quot;https://*/*&quot;</span> <span class="token comment">// 可以通过executeScript或者insertCSS访问的网站</span>\n <span class="token punctuation">]</span><span class="token punctuation">,</span>\n <span class="token comment">// 普通页面能够直接访问的插件资源列表，如果不设置是无法直接访问的</span>\n <span class="token string">&quot;web_accessible_resources&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;js/inject.js&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n <span class="token comment">// 插件主页，这个很重要，不要浪费了这个免费广告位</span>\n <span class="token string">&quot;homepage_url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://www.baidu.com&quot;</span><span class="token punctuation">,</span>\n <span class="token comment">// 覆盖浏览器默认页面</span>\n <span class="token string">&quot;chrome_url_overrides&quot;</span><span class="token operator">:</span>\n <span class="token punctuation">{</span>\n  <span class="token comment">// 覆盖浏览器默认的新标签页</span>\n  <span class="token string">&quot;newtab&quot;</span><span class="token operator">:</span> <span class="token string">&quot;newtab.html&quot;</span>\n <span class="token punctuation">}</span><span class="token punctuation">,</span>\n <span class="token comment">// Chrome40以前的插件配置页写法</span>\n <span class="token string">&quot;options_page&quot;</span><span class="token operator">:</span> <span class="token string">&quot;options.html&quot;</span><span class="token punctuation">,</span>\n <span class="token comment">// Chrome40以后的插件配置页写法，如果2个都写，新版Chrome只认后面这一个</span>\n <span class="token string">&quot;options_ui&quot;</span><span class="token operator">:</span>\n <span class="token punctuation">{</span>\n  <span class="token string">&quot;page&quot;</span><span class="token operator">:</span> <span class="token string">&quot;options.html&quot;</span><span class="token punctuation">,</span>\n  <span class="token comment">// 添加一些默认的样式，推荐使用</span>\n  <span class="token string">&quot;chrome_style&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>\n <span class="token punctuation">}</span><span class="token punctuation">,</span>\n <span class="token comment">// 向地址栏注册一个关键字以提供搜索建议，只能设置一个关键字</span>\n <span class="token string">&quot;omnibox&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;keyword&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;go&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n <span class="token comment">// 默认语言</span>\n <span class="token string">&quot;default_locale&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zh_CN&quot;</span><span class="token punctuation">,</span>\n <span class="token comment">// devtools页面入口，注意只能指向一个HTML文件，不能是JS文件</span>\n <span class="token string">&quot;devtools_page&quot;</span><span class="token operator">:</span> <span class="token string">&quot;devtools.html&quot;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br></div></div><h3 id="content-scripts"><a class="header-anchor" href="#content-scripts">#</a> content-scripts</h3><p>所谓<strong>content-scripts</strong>，其实就是 Chrome 插件中向页面注入脚本的一种形式（同时还可以包括 css），借助<strong>content-scripts</strong>我们可以实现通过配置的方式轻松向指定页面注入 JS 和 CSS。</p><p>示例配置：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>\n <span class="token comment">// 需要直接注入页面的JS</span>\n <span class="token string">&quot;content_scripts&quot;</span><span class="token operator">:</span>\n <span class="token punctuation">[</span>\n  <span class="token punctuation">{</span>\n   <span class="token comment">//&quot;matches&quot;: [&quot;http://*/*&quot;, &quot;https://*/*&quot;],</span>\n   <span class="token comment">// &quot;&lt;all_urls&gt;&quot; 表示匹配所有地址</span>\n   <span class="token string">&quot;matches&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;&lt;all_urls&gt;&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n   <span class="token comment">// 多个JS按顺序注入</span>\n   <span class="token string">&quot;js&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;js/jquery-1.8.3.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;js/content-script.js&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n   <span class="token comment">// JS的注入可以随便一点，但是CSS的注意就要千万小心了，因为一不小心就可能影响全局样式</span>\n   <span class="token string">&quot;css&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;css/custom.css&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n   <span class="token comment">// 代码注入的时间，可选值： &quot;document_start&quot;, &quot;document_end&quot;,</span>\n   <span class="token comment">// or &quot;document_idle&quot;，最后一个表示页面空闲时，默认document_idle</span>\n   <span class="token string">&quot;run_at&quot;</span><span class="token operator">:</span> <span class="token string">&quot;document_start&quot;</span>\n  <span class="token punctuation">}</span>\n <span class="token punctuation">]</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>content-scripts 和原始页面共享 DOM 但是不共享 JS，如要访问页面 JS（例如某个 JS 变量,或函数）,只能通过 injected scripts 来实现。content-scripts 能访问下面这 4 种 API:</p><ul><li>chrome.extension(getURL , inIncognitoContext , lastError , onRequest , sendRequest)</li><li>chrome.i18n</li><li>chrome.runtime(connect , getManifest , getURL , id , onConnect , onMessage , sendMessage)</li><li>chrome.storage<br> 非要调用其它 API 的话，你还可以让 background 来帮你调用然后通过通信来实现</li></ul><h3 id="background"><a class="header-anchor" href="#background">#</a> background</h3><p>后台脚本，是一个常驻的页面，它的生命周期是插件所有类型脚本中最长的，它随着浏览器的打开而打开，随着浏览器的关闭而关闭，所以把需要一直运行的、启动就运行的、全局代码放在 background 里面。</p><p>background 的权限非常高，几乎可以调用（除了 devtools）所有的 Chrome 扩展 API，而且它可以无限制跨域, 配置中，background 可以通过 page 指定一张网页，也可以通过 scripts 直接指定一个 JS，Chrome 会自动为这个 JS 生成一个默认的网页：</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>\n  <span class="token comment">// 会一直常驻的后台JS或后台页面</span>\n  <span class="token property">&quot;background&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 2种指定方式，如果指定JS，那么会自动生成一个背景页</span>\n    <span class="token property">&quot;page&quot;</span><span class="token operator">:</span> <span class="token string">&quot;background.html&quot;</span>\n    <span class="token comment">//&quot;scripts&quot;: [&quot;js/background.js&quot;]</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>虽然你可以通过 chrome-extension://xxx/background.html 直接打开后台页，但是你打开的后台页和真正一直在后台运行的那个页面不是同一个，换句话说，你可以打开无数个 background.html，但是真正在后台常驻的只有一个，而且这个你永远看不到它的界面，只能调试它的代码。</p></div><h3 id="event-pages"><a class="header-anchor" href="#event-pages">#</a> event-pages</h3><p>鉴于 background 生命周期太长，长时间挂载后台可能会影响性能，因此有了 event-pages(事件页面)，在配置文件上,它的使用方式和 background 一样,唯一区别就是多了一个 persistent 参数,配置成非持续存在。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>\n <span class="token string">&quot;background&quot;</span><span class="token operator">:</span>\n <span class="token punctuation">{</span>\n  <span class="token string">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;event-page.js&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token string">&quot;persistent&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>\n <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>它的生命周期是：在被需要时加载，在空闲时被关闭，什么叫被需要时呢？<br> 比如第一次安装、插件更新、与 content-script 进行通信时，所监听的事件被触发等。</p><h3 id="popup"><a class="header-anchor" href="#popup">#</a> popup</h3>',23),o=(0,t.Uk)("popup 是点击 browser_action 或者 page_action 图标时打开的一个小窗口网页，焦点离开网页就立即关闭，一般用来做一些临时性的交互。"),p=(0,t.Wm)("br",null,null,-1),c=(0,t.uE)('<p>可以通过 default_popup 字段来指定 popup 页面，也可以调用 setPopup()动态注册。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>\n <span class="token string">&quot;browser_action&quot;</span><span class="token operator">:</span>\n <span class="token punctuation">{</span>\n  <span class="token string">&quot;default_icon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;img/icon.png&quot;</span><span class="token punctuation">,</span>\n  <span class="token comment">// 图标悬停时的标题，可选</span>\n  <span class="token string">&quot;default_title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;这是一个示例Chrome插件&quot;</span><span class="token punctuation">,</span>\n  <span class="token string">&quot;default_popup&quot;</span><span class="token operator">:</span> <span class="token string">&quot;popup.html&quot;</span>\n <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>所以 popup 页面的生命周期很短,权限上和 background 非常类似，popup 通过 chrome.extension.getBackgroundPage()可以直接获取 background 的 window 对象。</p></div><h3 id="injected-script"><a class="header-anchor" href="#injected-script">#</a> injected-script</h3><p>通过 DOM 操作的方式向页面注入的一种 JS。因为 content-script 有一个很大的“缺陷”，也就是<strong>无法访问页面中的 JS</strong>，虽然它可以操作 DOM，但是 DOM 却不能调用它，也就是无法在 DOM 中通过绑定事件的方式调用 content-script 中的代码.</p><p>在 content-script 中通过 DOM 方式向页面注入 inject-script 代码示例：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 向页面注入JS</span>\n<span class="token keyword">function</span> <span class="token function">injectCustomJs</span><span class="token punctuation">(</span><span class="token parameter">jsPath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  jsPath <span class="token operator">=</span> jsPath <span class="token operator">||</span> <span class="token string">&quot;js/inject.js&quot;</span><span class="token punctuation">;</span>\n  <span class="token keyword">var</span> temp <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;script&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  temp<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;text/javascript&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// 获得的地址类似：chrome-extension://demo/js/inject.js</span>\n  temp<span class="token punctuation">.</span>src <span class="token operator">=</span> chrome<span class="token punctuation">.</span>extension<span class="token punctuation">.</span><span class="token function">getURL</span><span class="token punctuation">(</span>jsPath<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  temp<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 放在页面不好看，执行完后移除掉</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>执行一下你会看到如下报错：</p><div class="custom-container danger"><p class="custom-container-title">DANGER</p><p>Denying load of chrome-extension:/demo/js/inject.js. Resources must be listed in the web_accessible_resources manifest key in order to be loaded by pages outside the extension.</p></div><p>意思就是你想要在 web 中直接访问插件中的资源的话必须显示声明才行，配置文件中增加如下：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>\n <span class="token comment">// 普通页面能够直接访问的插件资源列表，如果不设置是无法直接访问的</span>\n <span class="token string">&quot;web_accessible_resources&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;js/inject.js&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="option-选项页"><a class="header-anchor" href="#option-选项页">#</a> option(选项页)</h3>',12),l=(0,t.Uk)("options 页，是插件的设置页面，有 2 个入口,一个是右键图标有一个“选项”菜单，一个在插件管理页面： "),u=(0,t.uE)('<div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>\n <span class="token string">&quot;options_ui&quot;</span><span class="token operator">:</span>\n <span class="token punctuation">{</span>\n     <span class="token string">&quot;page&quot;</span><span class="token operator">:</span> <span class="token string">&quot;options.html&quot;</span><span class="token punctuation">,</span>\n  <span class="token comment">// 添加一些默认的样式，推荐使用</span>\n     <span class="token string">&quot;chrome_style&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>\n <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div>',1),m=(0,t.Uk)("配置之后在插件管理页就会看到一个选项按钮入口，点进去就是打开一个网页, 这里可以对你的插件进行配置并保存在本地。 数据存储建议用 chrome.storage，因为会随用户自动同步. "),i=(0,t.uE)('<h2 id="chrome-插件的六种展示形式"><a class="header-anchor" href="#chrome-插件的六种展示形式">#</a> Chrome 插件的六种展示形式</h2><ul><li>browserAction(地址栏右侧)</li><li>pageAction(地址栏右侧)</li><li>contextMenus(右键菜单)</li><li>override(覆盖特定页面)</li><li>devtools(开发者工具)</li><li>omnibox (搜索建议扩展)</li></ul><h3 id="browseraction-地址栏右侧"><a class="header-anchor" href="#browseraction-地址栏右侧">#</a> browserAction(地址栏右侧)</h3><p>通过配置 browser_action 可以在浏览器的右上角增加一个图标，<br> 一个 browser_action 可以拥有一个图标，一个 tooltip，一个 badge 和一个 popup。</p><p>示例配置如下：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&quot;browser_action&quot;</span><span class="token operator">:</span>\n<span class="token punctuation">{</span>\n <span class="token string">&quot;default_icon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;img/icon.png&quot;</span><span class="token punctuation">,</span>\n <span class="token string">&quot;default_title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;这是一个示例Chrome插件&quot;</span><span class="token punctuation">,</span>\n <span class="token string">&quot;default_popup&quot;</span><span class="token operator">:</span> <span class="token string">&quot;popup.html&quot;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div>',6),r=(0,t.Uk)("图标"),k=(0,t.Wm)("br",null,null,-1),W=(0,t.Uk)(" browser_action 图标推荐使用宽高都为 19 像素的图片，更大的图标会被缩小，可以通过 manifest 中 default_icon 字段配置，也可以调用 setIcon()方法。"),b=(0,t.Wm)("br",null,null,-1),d=(0,t.Uk)(" tooltip"),g=(0,t.Wm)("br",null,null,-1),U=(0,t.Uk)(" 修改 browser_action 的 manifest 中 default_title 字段，或者调用 setTitle()方法。"),h=(0,t.Wm)("br",null,null,-1),q=(0,t.Uk)(" badge"),v=(0,t.Wm)("br",null,null,-1),f=(0,t.Uk)(" 所谓 badge 就是在图标上显示一些文本，可以用来更新一些小的扩展状态提示信息。 因为 badge 空间有限，所以只支持（英文 4 个，中文 2 个）字符。 badge 无法通过配置文件来指定，必须通过代码实现。"),w=(0,t.uE)('<div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>chrome<span class="token punctuation">.</span>browserAction<span class="token punctuation">.</span><span class="token function">setBadgeText</span><span class="token punctuation">(</span><span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token string">&quot;new&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nchrome<span class="token punctuation">.</span>browserAction<span class="token punctuation">.</span><span class="token function">setBadgeBackgroundColor</span><span class="token punctuation">(</span><span class="token punctuation">{</span> color<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div>',1),j=(0,t.Wm)("h3",{id:"pageaction-地址栏右侧"},[(0,t.Wm)("a",{class:"header-anchor",href:"#pageaction-地址栏右侧"},"#"),(0,t.Uk)(" pageAction(地址栏右侧)")],-1),x=(0,t.Uk)("pageAction 和普通的 browserAction 一样也是放在浏览器右上角，只不过没有点亮时是灰色的，点亮了才是彩色的，灰色时无论左键还是右键单击都是弹出选项："),y=(0,t.Wm)("br",null,null,-1),_=(0,t.Uk)(" 示例(只有打开百度才点亮图标)： "),C=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token string"},'"page_action"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token string"},'"default_icon"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"img/icon.png"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token string"},'"default_title"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"我是pageAction"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token string"},'"default_popup"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"popup.html"'),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token string"},'"permissions"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},'"declarativeContent"'),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br")])],-1),M=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Uk)("chrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("runtime"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("onInstalled"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"addListener"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  chrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("declarativeContent"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("onPageChanged"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"removeRules"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"undefined"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    chrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("declarativeContent"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("onPageChanged"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"addRules"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        conditions"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n          "),(0,t.Wm)("span",{class:"token comment"},"// 只有打开百度才显示pageAction"),(0,t.Uk)("\n          "),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},[(0,t.Uk)("chrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("declarativeContent"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("PageStateMatcher")]),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" pageUrl"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" urlContains"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"baidu.com"'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        actions"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},[(0,t.Uk)("chrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("declarativeContent"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("ShowPageAction")]),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"13"),(0,t.Wm)("br")])],-1),S=(0,t.Wm)("h3",{id:"contextmenus-右键菜单"},[(0,t.Wm)("a",{class:"header-anchor",href:"#contextmenus-右键菜单"},"#"),(0,t.Uk)(" contextMenus(右键菜单)")],-1),I=(0,t.Wm)("p",null,[(0,t.Uk)("通过开发 Chrome 插件可以自定义浏览器的右键菜单，主要是通过"),(0,t.Wm)("strong",null,"chrome.contextMenusAPI"),(0,t.Uk)("实现，右键菜单可以出现在不同的上下文，比如普通页面、选中的文字、图片、链接，等等"),(0,t.Wm)("br"),(0,t.Uk)(" 添加右键百度搜索:")],-1),R=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token string"},'"permissions"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},'"contextMenus"'),(0,t.Uk)("， "),(0,t.Wm)("span",{class:"token string"},'"tabs"'),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br")])],-1),A=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Uk)("chrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("contextMenus"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"create"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  title"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"使用度娘搜索：%s"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// %s表示选中的文字"),(0,t.Uk)("\n  contexts"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},'"selection"'),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 只有当选中文字时才会出现此右键菜单"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token function-variable function"},"onclick"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"params"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// 注意不能使用location.href，因为location是属于background的window对象"),(0,t.Uk)("\n    chrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("tabs"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"create"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      url"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"https://www.baidu.com/s?ie=utf-8&wd="'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"encodeURI"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("params"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("selectionText"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br")])],-1),P=(0,t.Wm)("h3",{id:"override-覆盖特定页面"},[(0,t.Wm)("a",{class:"header-anchor",href:"#override-覆盖特定页面"},"#"),(0,t.Uk)(" override(覆盖特定页面)")],-1),E=(0,t.Wm)("p",null,"使用 override 页可以将 Chrome 默认的一些特定页面替换掉，改为使用扩展提供的页面。",-1),L=(0,t.Wm)("p",null,"扩展可以替代如下页面：",-1),T=(0,t.Wm)("li",null,"历史记录：从工具菜单上点击历史记录时访问的页面，或者从地址栏直接输入 chrome://history",-1),J=(0,t.Wm)("li",null,"新标签页：当创建新标签的时候访问的页面，或者从地址栏直接输入 chrome://newtab",-1),D=(0,t.Wm)("li",null,[(0,t.Uk)("书签：浏览器的书签，或者直接输入 chrome://bookmarks"),(0,t.Wm)("div",{class:"custom-container warning"},[(0,t.Wm)("p",{class:"custom-container-title"},"WARNING")])],-1),B=(0,t.Wm)("li",null,"一个扩展只能替代一个页面；",-1),O=(0,t.Wm)("li",null,"不能替代隐身窗口的新标签页；",-1),$=(0,t.Wm)("li",null,"网页必须设置 title，否则用户可能会看到网页的 URL，造成困扰；",-1),N=(0,t.Uk)("一个插件只能替代一个默认页"),G=(0,t.Wm)("br",null,null,-1),H=(0,t.Uk)(" :::"),z=(0,t.Wm)("br",null,null,-1),Y=(0,t.Uk)(" 下面的截图是默认的新标签页和被扩展替换掉的新标签页。 "),F=(0,t.uE)('<div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// manifest.json</span>\n<span class="token string">&quot;chrome_url_overrides&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>\n <span class="token string">&quot;newtab&quot;</span><span class="token operator">:</span> <span class="token string">&quot;newtab.html&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 替换新标签页</span>\n<span class="token comment">// &quot;history&quot;: &quot;history.html&quot;, // 替换历史记录页</span>\n<span class="token comment">// &quot;bookmarks&quot;: &quot;bookmarks.html&quot; // 替换书签页</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="devtools-开发者工具"><a class="header-anchor" href="#devtools-开发者工具">#</a> devtools(开发者工具)</h3><p>每打开一个开发者工具窗口，都会创建 devtools 页面的实例，窗口关闭，页面也随着关闭，所以 devtools 页面的生命周期和 devtools 窗口是一致的。devtools 页面可以访问一组特有的 DevTools API 以及有限的扩展 API，这组特有的<strong>DevTools API 只有 devtools 页面才可以访问</strong>，这些 API 包括：</p><ul><li>chrome.devtools.panels：面板相关；</li><li>chrome.devtools.inspectedWindow：获取被审查窗口的有关信息；</li><li>chrome.devtools.network：获取有关网络请求的信息；</li></ul><p>大部分扩展 API 都无法直接被 DevTools 页面调用，但它可以像 content-script 一样直接调用 chrome.extension 和 chrome.runtimeAPI，同时它也可以像 content-script 一样使用 Message 交互的方式与 background 页面进行通信。</p><p>实例：创建一个 devtools 扩展 首先，要针对开发者工具开发插件，需要在清单文件声明如下：</p>',6),V=(0,t.Wm)("div",{class:"language-json ext-json line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-json"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},"// 只能指向一个HTML文件，不能是JS文件"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token property"},'"devtools_page"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"devtools.html"'),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br")])],-1),K=(0,t.Wm)("div",{class:"language-html ext-html line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-html"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token doctype"},[(0,t.Wm)("span",{class:"token punctuation"},"<!"),(0,t.Wm)("span",{class:"token doctype-tag"},"DOCTYPE"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token name"},"html"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Uk)("html")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Uk)("head")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"</"),(0,t.Uk)("head")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Uk)("body")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Uk)("script")]),(0,t.Uk)(),(0,t.Wm)("span",{class:"token attr-name"},"type"),(0,t.Wm)("span",{class:"token attr-value"},[(0,t.Wm)("span",{class:"token punctuation attr-equals"},"="),(0,t.Wm)("span",{class:"token punctuation"},'"'),(0,t.Uk)("text/javascript"),(0,t.Wm)("span",{class:"token punctuation"},'"')]),(0,t.Uk)(),(0,t.Wm)("span",{class:"token attr-name"},"src"),(0,t.Wm)("span",{class:"token attr-value"},[(0,t.Wm)("span",{class:"token punctuation attr-equals"},"="),(0,t.Wm)("span",{class:"token punctuation"},'"'),(0,t.Uk)("js/devtools.js"),(0,t.Wm)("span",{class:"token punctuation"},'"')]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Wm)("span",{class:"token script"}),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"</"),(0,t.Uk)("script")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"</"),(0,t.Uk)("body")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"</"),(0,t.Uk)("html")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br")])],-1),Q=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// 几个参数依次为：panel标题、图标（其实设置了也没地方显示）、要加载的页面、加载成功后的回调"),(0,t.Uk)("\nchrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("devtools"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("panels"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"create"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"MyPanel"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"img/icon.png"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"mypanel.html"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"panel"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  console"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"自定义面板创建成功！"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 注意这个log一般看不到"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token comment"},"// 创建自定义侧边栏"),(0,t.Uk)("\nchrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("devtools"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("panels"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("elements"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"createSidebarPane"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"Images"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"sidebar"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},"// sidebar.setPage('../sidebar.html'); // 指定加载某个页面"),(0,t.Uk)("\n  sidebar"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"setExpression"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'document.querySelectorAll(\"img\")'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"All Images"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 通过表达式来指定"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},"//sidebar.setObject({aaa: 111, bbb: 'Hello World!'}); // 直接设置显示某个对象"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br")])],-1),X=(0,t.Wm)("div",{class:"language-html ext-html line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-html"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token doctype"},[(0,t.Wm)("span",{class:"token punctuation"},"<!"),(0,t.Wm)("span",{class:"token doctype-tag"},"DOCTYPE"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token name"},"html"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Uk)("html")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Uk)("head")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"</"),(0,t.Uk)("head")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Uk)("body")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Uk)("h1")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("这是一个自定义的侧边栏"),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"</"),(0,t.Uk)("h1")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"</"),(0,t.Uk)("body")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"</"),(0,t.Uk)("html")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br")])],-1),Z=(0,t.Wm)("h3",{id:"omnibox-搜索建议"},[(0,t.Wm)("a",{class:"header-anchor",href:"#omnibox-搜索建议"},"#"),(0,t.Uk)(" omnibox (搜索建议)")],-1),nn=(0,t.Uk)("注册某个关键字以触发插件自己的搜索建议界面，然后可以任意发挥了。 "),sn=(0,t.Wm)("div",{class:"language-json ext-json line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-json"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},"// 向地址栏注册一个关键字以提供搜索建议，只能设置一个关键字"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token property"},'"omnibox"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token property"},'"keyword"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"go"'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br")])],-1),an=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// omnibox 演示"),(0,t.Uk)("\nchrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("omnibox"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("onInputChanged"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"addListener"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("text"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" suggest")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token operator"},"!"),(0,t.Uk)("text"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("text "),(0,t.Wm)("span",{class:"token operator"},"=="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"微博"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token function"},"suggest"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" content"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"新浪"'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(" text"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" description"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"新浪"'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(" text "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" content"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"腾讯"'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(" text"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" description"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"腾讯"'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(" text "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" content"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"搜狐"'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(" text"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" description"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"搜索"'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(" text "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token function"},"suggest"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" content"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"百度搜索 "'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(" text"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" description"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"百度搜索 "'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(" text "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" content"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"谷歌搜索 "'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(" text"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" description"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"谷歌搜索 "'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(" text "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token comment"},"// 当用户接收关键字建议时触发"),(0,t.Uk)("\nchrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("omnibox"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("onInputEntered"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"addListener"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"text"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token operator"},"!"),(0,t.Uk)("text"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"var"),(0,t.Uk)(" href "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'""'),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("text"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"startsWith"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"百度搜索"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    href "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"https://www.baidu.com/s?ie=UTF-8&wd="'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(" text"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"replace"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"百度搜索 "'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'""'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("text"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"startsWith"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"谷歌搜索"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    href "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"https://www.google.com.tw/search?q="'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(" text"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"replace"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"谷歌搜索 "'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'""'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"else"),(0,t.Uk)(" href "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"https://www.baidu.com/s?ie=UTF-8&wd="'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(" text"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token function"},"openUrlCurrentTab"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("href"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token comment"},"// 获取当前选项卡ID"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"getCurrentTabId"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"callback"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  chrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("tabs"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"query"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" active"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" currentWindow"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"tabs"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("callback"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"callback"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("tabs"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("length "),(0,t.Wm)("span",{class:"token operator"},"?"),(0,t.Uk)(" tabs"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token number"},"0"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("id "),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"null"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token comment"},"// 当前标签打开某个链接"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"openUrlCurrentTab"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"url"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token function"},"getCurrentTabId"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"tabId"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    chrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("tabs"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"update"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("tabId"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" url"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" url "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"13"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"14"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"15"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"16"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"17"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"18"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"19"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"20"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"21"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"22"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"23"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"24"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"25"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"26"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"27"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"28"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"29"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"30"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"31"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"32"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"33"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"34"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"35"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"36"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"37"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"38"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"39"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"40"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"41"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"42"),(0,t.Wm)("br")])],-1),tn=(0,t.Wm)("h2",{id:"五种-js-类型的对比"},[(0,t.Wm)("a",{class:"header-anchor",href:"#五种-js-类型的对比"},"#"),(0,t.Uk)(" 五种 JS 类型的对比")],-1),en=(0,t.Wm)("p",null,[(0,t.Uk)("Chrome 插件的 JS 主要可以分为这 5 类："),(0,t.Wm)("br"),(0,t.Wm)("strong",null,"injected script、content-script、popup js、background js、devtools js"),(0,t.Uk)("，")],-1),on=(0,t.Wm)("h3",{id:"权限对比"},[(0,t.Wm)("a",{class:"header-anchor",href:"#权限对比"},"#"),(0,t.Uk)(" 权限对比")],-1),pn=(0,t.uE)('<h3 id="消息通信"><a class="header-anchor" href="#消息通信">#</a> 消息通信</h3><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>注：--表示不存在或者无意义，或者待验证。</p></div><table><thead><tr><th>js 类型</th><th>injected-script</th><th>content-script</th><th>popup-js</th><th>background-js</th></tr></thead><tbody><tr><td>injected-script</td><td>--</td><td>window.postMessage</td><td>--</td><td>--</td></tr><tr><td>content-script</td><td>window.postMessage</td><td>--</td><td>chrome.runtime.sendMessage chrome.runtime.connect</td><td>chrome.runtime.sendMessage chrome.runtime.connect</td></tr><tr><td>popup-js</td><td>--</td><td>chrome.tabs.sendMessage chrome.tabs.connect</td><td>--</td><td>chrome.extension. getBackgroundPage()</td></tr><tr><td>background-js</td><td>--</td><td>chrome.tabs.sendMessage chrome.tabs.connect</td><td>chrome.extension.getViews</td><td>--</td></tr><tr><td>devtools-js</td><td>chrome.devtools. inspectedWindow.eval</td><td>--</td><td>chrome.runtime.sendMessage</td><td>chrome.runtime.sendMessage</td></tr></tbody></table><h3 id="通信详细介绍"><a class="header-anchor" href="#通信详细介绍">#</a> 通信详细介绍</h3><p>popup 和 background popup 可以直接调用 background 中的 JS 方法，也可以直接访问 background 的 DOM：</p>',5),cn=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"xipi"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token function"},"alert"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"我是background.js！的xipi方法"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br")])],-1),ln=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"var"),(0,t.Uk)(" bg "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" chrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("extension"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"getBackgroundPage"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nbg"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"test"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 访问bg的函数"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token function"},"alert"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("bg"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("document"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("body"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("innerHTML"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 访问bg的DOM"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br")])],-1),un=(0,t.uE)('<p>至于 background 访问 popup 如下（前提是 popup 已经打开）：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> views <span class="token operator">=</span> chrome<span class="token punctuation">.</span>extension<span class="token punctuation">.</span><span class="token function">getViews</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&quot;popup&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>views<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>views<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>popup 或者 bg 向 content 主动发送消息:</p>',3),mn=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"sendMessageToContentScript"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("message"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" callback")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  chrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("tabs"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"query"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" active"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" currentWindow"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"tabs"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    chrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("tabs"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"sendMessage"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("tabs"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token number"},"0"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("id"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" message"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"response"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("callback"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"callback"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("response"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token function"},"sendMessageToContentScript"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" cmd"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"test"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" value"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"你好，我是popup！"'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"response"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  console"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"来自content的回复："'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(" response"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br")])],-1),rn=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Uk)("chrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("runtime"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("onMessage"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"addListener"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("request"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" sender"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" sendResponse")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},'// console.log(sender.tab ?"from a content script:" + sender.tab.url :"from the extension");'),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("request"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("cmd "),(0,t.Wm)("span",{class:"token operator"},"=="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"test"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"alert"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("request"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("value"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token function"},"sendResponse"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"我收到了你的消息！"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br")])],-1),kn=(0,t.Wm)("h3",{id:"content-script-主动发消息给后台"},[(0,t.Wm)("a",{class:"header-anchor",href:"#content-script-主动发消息给后台"},"#"),(0,t.Uk)(" content-script 主动发消息给后台")],-1),Wn=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Uk)("chrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("runtime"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"sendMessage"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" greeting"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"你好，我是content-script呀，我主动发消息给后台！"'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"response"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"收到来自后台的回复："'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(" response"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br")])],-1),bn=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Uk)("chrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("runtime"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("onMessage"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"addListener"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("request"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" sender"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" sendResponse")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  console"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"收到来自content-script的消息："'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  console"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("request"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" sender"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" sendResponse"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token function"},"sendResponse"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"我是后台，我已收到你的消息："'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token constant"},"JSON"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"stringify"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("request"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br")])],-1),dn=(0,t.Wm)("p",null,"注意事项：",-1),gn=(0,t.Wm)("div",{class:"custom-container warning"},[(0,t.Wm)("p",{class:"custom-container-title"},"WARNING"),(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"content_scripts 向 popup 主动发消息的前提是 popup 必须打开！否则需要利用 background 中转；"),(0,t.Wm)("li",null,"如果 background 和 popup 同时监听，那么它们都可以同时收到消息，但是只有一个可以 sendResponse，一个先发送了，那么另外一个再发送就无效；")])],-1),Un=(0,t.Wm)("h3",{id:"injected-script-和-content-script"},[(0,t.Wm)("a",{class:"header-anchor",href:"#injected-script-和-content-script"},"#"),(0,t.Uk)(" injected script 和 content-script")],-1),hn=(0,t.Wm)("p",null,"content-script 和页面内的脚本（injected-script 自然也属于页面内的脚本）之间唯一共享的东西就是页面的 DOM 元素，有 2 种方法可以实现二者通讯：",-1),qn=(0,t.Wm)("p",null,"可以通过 window.postMessage 和 window.addEventListener 来实现二者消息通讯； 通过自定义 DOM 事件来实现；",-1),vn=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Uk)("window"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"postMessage"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" test"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"你好！"'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"*"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br")])],-1),fn=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Uk)("window"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"addEventListener"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token string"},'"message"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"e"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("e"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("data"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token boolean"},"false"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br")])],-1),wn=(0,t.Wm)("h3",{id:"长连接和短连接"},[(0,t.Wm)("a",{class:"header-anchor",href:"#长连接和短连接"},"#"),(0,t.Uk)(" 长连接和短连接")],-1),jn=(0,t.Wm)("p",null,"Chrome 插件中有 2 种通信方式:",-1),xn=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"一个是短连接（chrome.tabs.sendMessage 和 chrome.runtime.sendMessage），"),(0,t.Wm)("li",null,"一个是长连接（chrome.tabs.connect 和 chrome.runtime.connect）。")],-1),yn=(0,t.Wm)("p",null,"短连接的话就类似 ajax 通信上面就是, 而长连接类似 WebSocket 会建立连接， 双方可以随时互发消息。",-1),_n=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token function"},"getCurrentTabId"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"tabId"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"var"),(0,t.Uk)(" port "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" chrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("tabs"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"connect"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("tabId"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" name"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"test-connect"'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  port"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"postMessage"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" question"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"你是谁啊？"'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  port"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("onMessage"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"addListener"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"msg"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token function"},"alert"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"收到消息："'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(" msg"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("answer"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("msg"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("answer "),(0,t.Wm)("span",{class:"token operator"},"&&"),(0,t.Uk)(" msg"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("answer"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"startsWith"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"我是"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      port"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"postMessage"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" question"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"哦，原来是你啊！"'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br")])],-1),Cn=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Uk)("chrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("runtime"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("onConnect"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"addListener"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"port"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  console"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("port"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("port"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("name "),(0,t.Wm)("span",{class:"token operator"},"=="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"test-connect"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    port"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("onMessage"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"addListener"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"msg"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      console"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"收到长连接消息："'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" msg"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("msg"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("question "),(0,t.Wm)("span",{class:"token operator"},"=="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"你是谁啊？"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(" port"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"postMessage"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" answer"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"我是小明！"'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br")])],-1),Mn=(0,t.Wm)("h3",{id:"跨扩展程序消息传递"},[(0,t.Wm)("a",{class:"header-anchor",href:"#跨扩展程序消息传递"},"#"),(0,t.Uk)(" 跨扩展程序消息传递")],-1),Sn=(0,t.Wm)("p",null,"除了在您的扩展程序的不同组成部分间发送消息以外，您也可以使用消息传递 API 与其他扩展程序通信。这样您可以提供一个公共的 API，让其他扩展程序使用。",-1),In=(0,t.Wm)("p",null,[(0,t.Uk)("监听传入的请求和连接与处理内部的消息类似，"),(0,t.Wm)("br"),(0,t.Uk)(" 唯一的区别是您分别使用 runtime.onMessageExternal 和 runtime.onConnectExternal 事件。"),(0,t.Wm)("br"),(0,t.Uk)(" 如下是分别处理这两个事件的例子：同样，向另一个扩展程序发送消息与在您的扩展程序中发送消息类似，唯一的区别是您必须传递您需要与之通信的扩展程序的标识符。")],-1),Rn=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// 我们需要与之通信的扩展程序的标识符。"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"var"),(0,t.Uk)(" laserExtensionId "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"abcdefghijklmnoabcdefhijklmnoabc"'),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token comment"},"// 发出一个简单请求："),(0,t.Uk)("\nchrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("runtime"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"sendMessage"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("laserExtensionId"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("getTargetData"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"response"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token function"},"targetInRange"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("response"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("targetData"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n      chrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("runtime"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"sendMessage"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("laserExtensionId"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("activateLasers"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token comment"},"// 建立一个长时间的连接："),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"var"),(0,t.Uk)(" port "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" chrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("runtime"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"connect"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("laserExtensionId"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nport"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"postMessage"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token operator"},"..."),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"13"),(0,t.Wm)("br")])],-1),An=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token comment"},"// 用于简单的请求："),(0,t.Uk)("\nchrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("runtime"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("onMessageExternal"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"addListener"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("request"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" sender"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" sendResponse")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("sender"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("id "),(0,t.Wm)("span",{class:"token operator"},"=="),(0,t.Uk)(" blacklistedExtension"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},"// 不允许这一扩展程序访问"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("request"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("getTargetData"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"sendResponse"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" targetData"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" targetData "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("request"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("activateLasers"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"var"),(0,t.Uk)(" success "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"activateLasers"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token function"},"sendResponse"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" activateLasers"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" success "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token comment"},"// 用于长时间的连接："),(0,t.Uk)("\nchrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("runtime"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("onConnectExternal"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"addListener"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"port"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  port"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("onMessage"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"addListener"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"msg"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// 有关处理 onMessage 事件的示例请参见其他例子"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"13"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"14"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"15"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"16"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"17"),(0,t.Wm)("br")])],-1),Pn=(0,t.uE)('<h2 id="其它补充"><a class="header-anchor" href="#其它补充">#</a> 其它补充</h2><h3 id="本地存储"><a class="header-anchor" href="#本地存储">#</a> 本地存储</h3><p>本地存储建议用 chrome.storage 而不是普通的 localStorage，最重要的 2 点区别是：</p><ul><li>chrome.storage 是针对插件全局的，即使你在 background 中保存的数据，在 content-script 也能获取到；</li><li>chrome.storage.sync 可以跟随当前登录用户自动同步，这台电脑修改的设置会自动同步到其它电脑，很方便，如果没有登录或者未联网则先保存到本地，等登录了再同步至网络；</li></ul><p>需要声明 storage 权限，有 chrome.storage.sync 和 chrome.storage.local2 种方式可供选择，使用示例如下：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 读取数据，第一个参数是指定要读取的key以及设置默认值</span>\nchrome<span class="token punctuation">.</span>storage<span class="token punctuation">.</span>sync<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span> color<span class="token operator">:</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">items</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>items<span class="token punctuation">.</span>color<span class="token punctuation">,</span> items<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// 保存数据</span>\nchrome<span class="token punctuation">.</span>storage<span class="token punctuation">.</span>sync<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span> color<span class="token operator">:</span> <span class="token string">&quot;blue&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;保存成功！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="webrequest"><a class="header-anchor" href="#webrequest">#</a> webRequest</h3>',7),En=(0,t.Uk)("通过 webRequest 系列 API 可以对 HTTP 请求进行任性地修改、定制， "),Ln=(0,t.Wm)("p",null,"这里通过 beforeRequest 来简单演示一下它的冰山一角：",-1),Tn=(0,t.Wm)("div",{class:"language-json ext-json line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-json"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},"// 权限申请"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token property"},'"permissions"'),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token string"},'"webRequest"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// web请求"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token string"},'"webRequestBlocking"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 阻塞式web请求"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token string"},'"storage"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 插件本地存储"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token string"},'"http://*/*"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 可以通过executeScript或者insertCSS访问的网站"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token string"},'"https://*/*"'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 可以通过executeScript或者insertCSS访问的网站"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br")])],-1),Jn=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"var"),(0,t.Uk)(" showImage"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 是否显示图片"),(0,t.Uk)("\nchrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("storage"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("sync"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"get"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" showImage"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"items"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  showImage "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" items"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("showImage"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// web请求监听，最后一个参数表示阻塞式，需单独声明权限：webRequestBlocking"),(0,t.Uk)("\nchrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("webRequest"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("onBeforeRequest"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"addListener"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"details"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// cancel 表示取消本次请求"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token operator"},"!"),(0,t.Uk)("showImage "),(0,t.Wm)("span",{class:"token operator"},"&&"),(0,t.Uk)(" details"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("type "),(0,t.Wm)("span",{class:"token operator"},"=="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"image"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" cancel"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// 简单的音视频检测"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// 大部分网站视频的type并不是media，所以这里仅仅是为了演示效果，无实际意义"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("details"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("type "),(0,t.Wm)("span",{class:"token operator"},"=="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"media"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      chrome"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("notifications"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"create"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"null"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        type"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"basic"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        iconUrl"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"img/icon.png"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        title"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"检测到音视频"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        message"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"音视频地址："'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(" details"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("url"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" urls"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},'"<all_urls>"'),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token string"},'"blocking"'),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"13"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"14"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"15"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"16"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"17"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"18"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"19"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"20"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"21"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"22"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"23"),(0,t.Wm)("br")])],-1),Dn=(0,t.Wm)("p",null,"参考链接:",-1),Bn={href:"https://developer.chrome.com/docs/extensions/",target:"_blank",rel:"noopener noreferrer"},On=(0,t.Uk)("https://developer.chrome.com/docs/extensions/"),$n={href:"https://crxdoc-zh.appspot.com/extensions/webRequest",target:"_blank",rel:"noopener noreferrer"},Nn=(0,t.Uk)("https://crxdoc-zh.appspot.com/extensions/webRequest"),Gn={render:function(n,s){const a=(0,t.up)("CodeGroupItem"),Gn=(0,t.up)("CodeGroup"),Hn=(0,t.up)("OutboundLink");return(0,t.wg)(),(0,t.j4)(t.HY,null,[(0,t.Wm)("img",{src:n.$withBase("./pages-assets/logo.png"),class:"show-in-center"},null,8,["src"]),e,(0,t.Wm)("p",null,[o,p,(0,t.Wm)("img",{src:n.$withBase("./pages-assets/popup.png"),class:"show-small-in-center"},null,8,["src"])]),c,(0,t.Wm)("p",null,[l,(0,t.Wm)("img",{src:n.$withBase("./pages-assets/option2.png"),class:"show-small-in-center"},null,8,["src"])]),u,(0,t.Wm)("p",null,[m,(0,t.Wm)("img",{src:n.$withBase("./pages-assets/option1.png"),class:"show-small-in-center"},null,8,["src"])]),i,(0,t.Wm)("p",null,[r,k,W,b,d,g,U,h,(0,t.Wm)("img",{src:n.$withBase("./pages-assets/tooltip.png"),class:"show-small-in-center"},null,8,["src"]),q,v,f]),w,(0,t.Wm)("img",{src:n.$withBase("./pages-assets/badge.png"),class:"show-small-in-center"},null,8,["src"]),j,(0,t.Wm)("p",null,[x,y,_,(0,t.Wm)("img",{src:n.$withBase("./pages-assets/pageAction.gif"),class:"show-small-in-center"},null,8,["src"])]),(0,t.Wm)(Gn,null,{default:(0,t.w5)((()=>[(0,t.Wm)(a,{title:"manifest.json",active:""},{default:(0,t.w5)((()=>[C])),_:1}),(0,t.Wm)(a,{title:"background.js"},{default:(0,t.w5)((()=>[M])),_:1})])),_:1}),S,I,(0,t.Wm)(Gn,null,{default:(0,t.w5)((()=>[(0,t.Wm)(a,{title:"manifest.json",active:""},{default:(0,t.w5)((()=>[R])),_:1}),(0,t.Wm)(a,{title:"background.js"},{default:(0,t.w5)((()=>[A])),_:1})])),_:1}),(0,t.Wm)("img",{src:n.$withBase("./pages-assets/contextbaidu.png"),class:"show-small-in-center"},null,8,["src"]),P,E,L,(0,t.Wm)("ul",null,[T,J,D,B,O,$,(0,t.Wm)("li",null,[N,G,H,z,Y,(0,t.Wm)("img",{src:n.$withBase("./pages-assets/override.png"),class:"show-small-in-center"},null,8,["src"])])]),F,(0,t.Wm)(Gn,null,{default:(0,t.w5)((()=>[(0,t.Wm)(a,{title:"manifest.json",active:""},{default:(0,t.w5)((()=>[V])),_:1}),(0,t.Wm)(a,{title:"devtools.html"},{default:(0,t.w5)((()=>[K])),_:1}),(0,t.Wm)(a,{title:"devtools.js"},{default:(0,t.w5)((()=>[Q])),_:1}),(0,t.Wm)(a,{title:"mypanel.html"},{default:(0,t.w5)((()=>[X])),_:1})])),_:1}),(0,t.Wm)("img",{src:n.$withBase("./pages-assets/devtool.png"),class:"show-small-in-center"},null,8,["src"]),Z,(0,t.Wm)("p",null,[nn,(0,t.Wm)("img",{src:n.$withBase("./pages-assets/search.png"),class:"show-small-in-center"},null,8,["src"])]),(0,t.Wm)(Gn,null,{default:(0,t.w5)((()=>[(0,t.Wm)(a,{title:"manifest.json"},{default:(0,t.w5)((()=>[sn])),_:1}),(0,t.Wm)(a,{title:"background.js"},{default:(0,t.w5)((()=>[an])),_:1})])),_:1}),tn,en,on,(0,t.Wm)("img",{src:n.$withBase("./pages-assets/jsType.png"),class:"show-in-center"},null,8,["src"]),pn,(0,t.Wm)(Gn,null,{default:(0,t.w5)((()=>[(0,t.Wm)(a,{title:"background.js",active:""},{default:(0,t.w5)((()=>[cn])),_:1}),(0,t.Wm)(a,{title:"popup.js"},{default:(0,t.w5)((()=>[ln])),_:1})])),_:1}),un,(0,t.Wm)(Gn,null,{default:(0,t.w5)((()=>[(0,t.Wm)(a,{title:"background.js||popup.js"},{default:(0,t.w5)((()=>[mn])),_:1}),(0,t.Wm)(a,{title:"content-script.js"},{default:(0,t.w5)((()=>[rn])),_:1})])),_:1}),kn,(0,t.Wm)(Gn,null,{default:(0,t.w5)((()=>[(0,t.Wm)(a,{title:"content-script.js"},{default:(0,t.w5)((()=>[Wn])),_:1}),(0,t.Wm)(a,{title:"background.js||popup.js"},{default:(0,t.w5)((()=>[bn])),_:1})])),_:1}),dn,gn,Un,hn,qn,(0,t.Wm)(Gn,null,{default:(0,t.w5)((()=>[(0,t.Wm)(a,{title:"injected-script.js"},{default:(0,t.w5)((()=>[vn])),_:1}),(0,t.Wm)(a,{title:"content-script.js"},{default:(0,t.w5)((()=>[fn])),_:1})])),_:1}),wn,jn,xn,yn,(0,t.Wm)(Gn,null,{default:(0,t.w5)((()=>[(0,t.Wm)(a,{title:"popup.js"},{default:(0,t.w5)((()=>[_n])),_:1}),(0,t.Wm)(a,{title:"content-script.js",active:""},{default:(0,t.w5)((()=>[Cn])),_:1})])),_:1}),Mn,Sn,In,(0,t.Wm)(Gn,null,{default:(0,t.w5)((()=>[(0,t.Wm)(a,{title:"发送消息",active:""},{default:(0,t.w5)((()=>[Rn])),_:1}),(0,t.Wm)(a,{title:"接收消息"},{default:(0,t.w5)((()=>[An])),_:1})])),_:1}),Pn,(0,t.Wm)("p",null,[En,(0,t.Wm)("img",{src:n.$withBase("./pages-assets/webrequest.png"),class:"show-in-center"},null,8,["src"])]),Ln,(0,t.Wm)(Gn,null,{default:(0,t.w5)((()=>[(0,t.Wm)(a,{title:"content-script.js"},{default:(0,t.w5)((()=>[Tn])),_:1}),(0,t.Wm)(a,{title:"background.js||popup.js"},{default:(0,t.w5)((()=>[Jn])),_:1})])),_:1}),Dn,(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,[(0,t.Wm)("a",Bn,[On,(0,t.Wm)(Hn)])]),(0,t.Wm)("li",null,[(0,t.Wm)("a",$n,[Nn,(0,t.Wm)(Hn)])])])],64)}}}}]);